(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-12b1b914"],{b4a7:function(t,a,e){},e1aa:function(t,a,e){"use strict";e.r(a);var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"home"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"content",style:"background:white"},[e("canvas",{ref:"canvas",attrs:{id:"canvas",width:"800",height:"800"}})]),e("div",{staticClass:"operations"},[e("div",{staticStyle:{height:"800px",margin:"0 auto"}},[t._v(" 1.选择需要加密的文件,或手绘后再执行第二步 "),e("el-button",{staticStyle:{width:"100%",margin:"10px auto"},attrs:{type:"success",size:"default"},on:{click:t.inputFile}},[t._v(" 选择加密内容(图片) ")]),t._v(" 2.保存加密画布信息 "),e("el-button",{staticStyle:{width:"100%",margin:"10px auto"},attrs:{type:"primary",size:"default"},on:{click:function(a){return t.getCanvasData("hiddenData")}}},[t._v(" 保存隐写的信息 ")]),t._v(" 3.选择需要隐写到的目标图片 "),e("el-button",{staticStyle:{width:"100%",margin:"10px auto"},attrs:{type:"success",size:"default"},on:{click:t.inputFile}},[t._v(" 选择文件 ")]),t._v(" 4.开始加密 "),e("el-button",{staticStyle:{width:"100%",margin:"10px auto"},attrs:{type:"primary",size:"default"},on:{click:t.inputFile}},[t._v(" 开始加密 ")]),t._v(" 5.加密完成,点击生成图片下载加密后的图片 "),e("el-button",{staticStyle:{width:"100%",margin:"10px auto"},attrs:{type:"primary",size:"default"},on:{click:t.exportCanvas}},[t._v(" 生成图片 ")])],1)])])},i=[],s=e("1da1"),c=(e("96cf"),e("7a94")),o=e("0a07"),r={components:{},data:function(){return{loading:!1,ctx:null,canvas:null,blockList:[],hiddenData:null}},inject:["contentReload"],watch:{$route:{handler:function(){this.contentReload()},immediate:!1}},mounted:function(){this.initCanvas()},methods:{initCanvas:function(){this.canvas=new c["fabric"].Canvas("canvas",{isDrawingMode:!0,selectable:!1,selection:!1,hoverCursor:"pointer",devicePixelRatio:!0,stroke:"lightgreen",strokeWidth:4}),this.ctx=this.canvas.getContext("2d"),this.canvas.freeDrawingBrush.color="blue",this.canvas.freeDrawingBrush.width=5},inputFile:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var e;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(o["a"])();case 2:e=a.sent,t.drawImage(e[0]);case 4:case"end":return a.stop()}}),a)})))()},drawImage:function(t){var a=this;this.loading=!0,c["fabric"].Image.fromURL(t,(function(t){var e=t.height>t.width?a.canvas.width/t.width:a.canvas.height/t.height;t.set({left:a.canvas.width/2,originX:"center",originY:"center",top:a.canvas.height/2,scaleX:e,scaleY:e,selectable:!1}),t.on("added",(function(t){setTimeout((function(){a.getCanvasData()}),500)})),a.canvas.add(t)}))},getCanvasData:function(){this.blockList=[];var t=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height).data;function a(t){return t=t>254?t-1:t,t=t%2==1?t-1:t,t}for(var e=0;e<t.length;e+=4)this.blockList.push([a(t[e]),a(t[e+1]),a(t[e+2]),a(t[e+3])]);console.log(this.blockList),this.loading=!1},drawHiddenData:function(){},processData:function(t){for(var a=t.data,e=0;e<a.length;e++)if(e%4==0)a[e]%2==0?a[e]=0:a[e]=255;else{if(e%4==3)continue;a[e]=0}ctx.putImageData(t,0,0)},merge:function(){var t,a,e=originalData.data;switch(color){case"R":t=0,a=3;break;case"G":t=1,a=2;break;case"B":t=2,a=1;break}for(var n=0;n<e.length;n++)n%4==t&&(0===newData[n+a]&&e[n]%2===1||0!==newData[n+a]&&e[n]%2===0)&&(255===e[n]?e[n]--:e[n]++);ctx.putImageData(originalData,0,0)},exportCanvas:function(){var t=this.canvas.toDataURL({width:this.canvas.width,height:this.canvas.height,left:0,top:0,format:"png"}),a=document.createElement("a");a.download="canvas.png",a.href=t,document.body.appendChild(a),a.click(),document.body.removeChild(a)},reload:function(){console.log(this.canvas.viewportTransform),this.canvas.deactivateAll().renderAll()}}},l=r,u=(e("e5fe"),e("2877")),d=Object(u["a"])(l,n,i,!1,null,"332179ce",null);a["default"]=d.exports},e5fe:function(t,a,e){"use strict";e("b4a7")}}]);
//# sourceMappingURL=chunk-12b1b914.b3b5844e.js.map