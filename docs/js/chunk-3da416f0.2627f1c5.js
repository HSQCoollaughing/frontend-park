(window["webpackJsonp_frontend-park"]=window["webpackJsonp_frontend-park"]||[]).push([["chunk-3da416f0"],{"04d1":function(t,e,n){var a=n("342f"),i=a.match(/firefox\/(\d+)/i);t.exports=!!i&&+i[1]},"0c1f":function(t,e,n){},"107c":function(t,e,n){var a=n("d039"),i=n("da84"),o=i.RegExp;t.exports=a((function(){var t=o("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")}))},1276:function(t,e,n){"use strict";var a=n("2ba4"),i=n("c65b"),o=n("e330"),r=n("d784"),c=n("44e7"),s=n("825a"),l=n("1d80"),u=n("4840"),d=n("8aa5"),h=n("50c4"),f=n("577e"),v=n("dc4a"),g=n("4dae"),p=n("14c3"),b=n("9263"),m=n("9f7f"),x=n("d039"),w=m.UNSUPPORTED_Y,y=4294967295,k=Math.min,I=[].push,C=o(/./.exec),E=o(I),R=o("".slice),M=!x((function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));r("split",(function(t,e,n){var o;return o="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,n){var o=f(l(this)),r=void 0===n?y:n>>>0;if(0===r)return[];if(void 0===t)return[o];if(!c(t))return i(e,o,t,r);var s,u,d,h=[],v=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),p=0,m=new RegExp(t.source,v+"g");while(s=i(b,m,o)){if(u=m.lastIndex,u>p&&(E(h,R(o,p,s.index)),s.length>1&&s.index<o.length&&a(I,h,g(s,1)),d=s[0].length,p=u,h.length>=r))break;m.lastIndex===s.index&&m.lastIndex++}return p===o.length?!d&&C(m,"")||E(h,""):E(h,R(o,p)),h.length>r?g(h,0,r):h}:"0".split(void 0,0).length?function(t,n){return void 0===t&&0===n?[]:i(e,this,t,n)}:e,[function(e,n){var a=l(this),r=void 0==e?void 0:v(e,t);return r?i(r,e,a,n):i(o,f(a),e,n)},function(t,a){var i=s(this),r=f(t),c=n(o,i,r,a,o!==e);if(c.done)return c.value;var l=u(i,RegExp),v=i.unicode,g=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(w?"g":"y"),b=new l(w?"^(?:"+i.source+")":i,g),m=void 0===a?y:a>>>0;if(0===m)return[];if(0===r.length)return null===p(b,r)?[r]:[];var x=0,I=0,C=[];while(I<r.length){b.lastIndex=w?0:I;var M,L=p(b,w?R(r,I):r);if(null===L||(M=k(h(b.lastIndex+(w?I:0)),r.length))===x)I=d(r,I,v);else{if(E(C,R(r,x,I)),C.length===m)return C;for(var _=1;_<=L.length-1;_++)if(E(C,L[_]),C.length===m)return C;I=x=M}}return E(C,R(r,x)),C}]}),!M,w)},"14c3":function(t,e,n){var a=n("da84"),i=n("c65b"),o=n("825a"),r=n("1626"),c=n("c6b6"),s=n("9263"),l=a.TypeError;t.exports=function(t,e){var n=t.exec;if(r(n)){var a=i(n,t,e);return null!==a&&o(a),a}if("RegExp"===c(t))return i(s,t,e);throw l("RegExp#exec called on incompatible receiver")}},"27a3":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home"},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"content",style:"background:"+t.background},[t._m(0),n("canvas",{ref:"canvas",attrs:{id:"canvas",width:"800",height:"800"}})]),n("div",{staticClass:"operations"},[n("div",{staticStyle:{height:"800px"}},[n("EasyForm",{attrs:{formParams:t.formParams},scopedSlots:t._u([{key:"inputFile",fn:function(e){return[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.inputFile}},[t._v(" 选择文件 ")]),n("div",[t._v("共选择"+t._s(t.imgList.length)+"个文件")])]}}])}),n("el-button",{attrs:{type:"primary",size:"default"},on:{click:t.reload}},[t._v("重置")]),n("el-button",{attrs:{type:"primary",size:"default"},on:{click:t.generateImg}},[t._v("生成图片")]),n("el-button",{attrs:{type:"success",size:"default"},on:{click:t.exportCanvas}},[t._v("导出图片")])],1)])])},i=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{"text-align":"left",width:"800px"}},[n("p",[t._v("使用方法:")]),n("p",{staticStyle:{"font-size":"12px"}},[t._v(" 选取目标文件后,再选取需要用来合成目标文件的素材图片,通过自定义的一些配置,生成像素图,点击导出图片即可 ")])])}],o=n("1da1");n("96cf"),n("4e82"),n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),n("9861"),n("99af");function r(t){return new Promise((function(e,n){try{var a=document.createElement("canvas");a.width=20,a.height=20;var i=new Image;i.src=t,i.onload=function(){console.log(i.width,i.height);var n=a.getContext("2d"),o=a.height/i.height;i.height=a.height,i.width=i.width*o,n.drawImage(i,0,0,a.width,a.height);for(var r=n.getImageData(0,0,a.width,a.height).data,c=0,s=0,l=0,u=0,d=0;d<a.height;d++)for(var h=0;h<a.width;h++)c+=r[4*(a.width*d+h)],s+=r[4*(a.width*d+h)+1],l+=r[4*(a.width*d+h)+2],u+=r[4*(a.width*d+h)+3];c/=a.width*a.height,s/=a.width*a.height,l/=a.width*a.height,u/=a.width*a.height,c=Math.round(c),s=Math.round(s),l=Math.round(l),u=Math.round(u),console.log("%c ".concat("rgba("+c+","+s+","+l+","+u+")","\n                                                                        "),"background: ".concat("rgba("+c+","+s+","+l+","+u+")",";")),e({color:[c,s,l,u],url:t})}}catch(o){n(o)}}))}var c=n("0a07");n("ac1f"),n("1276");function s(t){for(var e=[],n=0;n<t.length;n++){for(var a=[],i="",o=0;o<t[o].color.length;o++)i=t[n].color[o],i in a?++a[i]:a[i]=1;var r=[];for(var c in a)r.push({color:c.split(","),count:a[c]});r.sort((function(t,e){return e.count-t.count})),r[0].position=t[n].position,e.push(r[0])}return e}var l=n("7a94"),u={components:{},data:function(){return{imgList:[],blockList:[],blockMainColors:[],loading:!1,formParams:{data:{},formList:{targetFile:{type:"upload",label:"目标图片",limit:1,action:"#",listType:"file-list",fileList:[],autoUpload:!1,onChange:this.slectFile},inputFile:{type:"customItem",label:"素材图片",name:"inputFile"},aaa:{type:"select",label:"分布方式",placeholder:"请选择",selectOptions:[],disabled:!0},bbb:{type:"select",label:"高清程度",placeholder:"请选择",selectOptions:[],disabled:!0},ccc:{type:"switch",label:"连续重复:",placeholder:"请选择",disabled:!0},ddd:{type:"switch",label:"按比例调整",disabled:!0},eee:{type:"select",label:"方向／比例",selectOptions:[],disabled:!0},fff:{type:"slider",label:"贴片高度",disabled:!0},ggg:{type:"slider",label:"贴片宽度",disabled:!0}},labelWidth:"90px",rules:{}},background:"#91A8D0",ctx:null,canvas:null}},mounted:function(){this.initCanvas()},methods:{initCanvas:function(){this.canvas=new l["fabric"].Canvas("canvas",{isDrawingMode:!1,selectable:!1,selection:!1,hoverCursor:"pointer",devicePixelRatio:!0,stroke:"lightgreen",strokeWidth:4}),this.ctx=canvas.getContext("2d"),this.canvas.freeDrawingBrush.color="blue",this.canvas.freeDrawingBrush.width=5,this.addCanvasEvent()},reload:function(){console.log(this.canvas.viewportTransform),this.canvas.deactivateAll().renderAll()},generateImg:function(){var t=this;this.loading=!0;for(var e=[],n=0;n<this.blockMainColors.length;n++){e[n]={diffs:[]};for(var a=0;a<this.imgList.length;a++)e[n].diffs.push({url:this.imgList[a].url,diff:this.colorDiff(this.blockMainColors[n].color,this.imgList[a].color),color:this.imgList[a].color});e[n].diffs.sort((function(t,e){return t.diff-e.diff})),e[n].url=e[n].diffs[0].url,e[n].position=this.blockMainColors[n].position,e[n].Acolor=this.blockMainColors[n].color,e[n].Bcolor=e[n].diffs[0].color}this.loading=!1,console.log(e),e.forEach((function(e){l["fabric"].Image.fromURL(e.url,(function(n){var a=n.height>n.width?8/n.width:8/n.height;n.set({left:8*e.position[0],top:8*e.position[1],originX:"center",scaleX:a,scaleY:a}),t.canvas.add(n)}))}))},slectFile:function(t,e){var n=window.URL.createObjectURL(t.raw);this.drawImage(n)},inputFile:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var n,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(c["a"])();case 2:n=e.sent,t.loading=!0,a=0;case 5:if(!(a<n.length)){e.next=13;break}return e.next=8,r(n[a]);case 8:i=e.sent,t.imgList.push(i);case 10:a++,e.next=5;break;case 13:console.log(t.imgList),t.loading=!1;case 15:case"end":return e.stop()}}),e)})))()},drawLine:function(){for(var t=8,e=0;e<=this.canvas.width/t;e++)this.canvas.add(new l["fabric"].Line([e*t,0,e*t,this.canvas.height],{left:e*t,stroke:"gray",selectable:!1})),this.canvas.add(new l["fabric"].Line([0,e*t,this.canvas.height,e*t],{top:e*t,stroke:"gray",selectable:!1}))},getCanvasData:function(){for(var t=0;t<this.canvas.height/8;t++)for(var e=0;e<this.canvas.width/8;e++){var n=this.ctx.getImageData(8*e,8*t,8,8).data;this.blockList[100*t+e]={position:[e,t],color:[]};for(var a=0;a<n.length;a+=4)this.blockList[100*t+e].color.push([n[a],n[a+1],n[a+2],n[a+3]])}console.log(s(this.blockList)),this.mostBlockColor(this.blockList),this.loading=!1},drawImage:function(t){var e=this;this.loading=!0,l["fabric"].Image.fromURL(t,(function(t){var n=t.height>t.width?e.canvas.width/t.width:e.canvas.height/t.height;t.set({left:e.canvas.width/2,originX:"center",originY:"center",top:e.canvas.height/2,scaleX:n,scaleY:n,selectable:!1}),t.on("added",(function(t){setTimeout((function(){e.getCanvasData()}),500)})),e.canvas.add(t)}))},mostBlockColor:function(t){for(var e=0;e<t.length;e++){for(var n=0,a=0,i=0,o=0,r=0;r<t[e].color[r].length;r++)n+=t[e].color[r][0],a+=t[e].color[r][1],i+=t[e].color[r][2],o+=t[e].color[r][3];n/=t[e].color[0].length,a/=t[e].color[0].length,i/=t[e].color[0].length,o/=t[e].color[0].length,n=Math.round(n),a=Math.round(a),i=Math.round(i),o=Math.round(o),this.blockMainColors.push({position:t[e].position,color:[n,a,i,o]})}console.log(this.blockMainColors)},colorDiff:function(t,e){for(var n=0,a=0;a<t.length;a++)n+=Math.pow(t[a]-e[a],2);return Math.sqrt(n)},addCanvasEvent:function(){var t=this;this.canvas.on("after:render",(function(t){})),this.canvas.on("object:added",(function(t){})),this.canvas.on("mouse:down",(function(e){if(e.e.ctrlKey){var n=t.canvas.getPointer(e.e),a=parseInt(n.x),i=parseInt(n.y),o=t.ctx.getImageData(a,i,1,1).data;console.log("%c x,y:(".concat(a,",").concat(i,")/rgba(").concat(o[0],",").concat(o[1],",").concat(o[2],",").concat(o[3],")"),"background: rgba(".concat(o[0],",").concat(o[1],",").concat(o[2],",").concat(o[3],");"))}})),this.canvas.on("mouse:wheel",(function(e){e.e.preventDefault(),e.e.stopPropagation();var n=.05,a=new l["fabric"].Point(t.canvas.width/2-1,t.canvas.height/2-1);e.e.ctrlKey&&(e.e.altKey&&e.e.ctrlKey&&(a=new l["fabric"].Point(e.pointer.x,e.pointer.y)),t.zoom=(e.e.deltaY>0?-n:n)+t.canvas.getZoom(),t.zoom=Math.max(.1,t.zoom),t.zoom=Math.min(10,t.zoom),t.canvas.zoomToPoint(a,t.zoom))})),this.canvas.on({"mouse:down":function(e){e.e.altKey&&(t.panning=!0,t.canvas.selection=!1)},"mouse:up":function(e){t.panning=!1,t.canvas.selection=!0},"mouse:move":function(e){if(t.panning&&e&&e.e){var n=new l["fabric"].Point(e.e.movementX,e.e.movementY);t.canvas.relativePan(n)}}}),this.canvas.on({"object:moving":function(t){console.log(t),t.target.opacity=.5},"object:modified":function(t){t.target.opacity=1}})},exportCanvas:function(){var t=this.canvas.toDataURL({width:this.canvas.width,height:this.canvas.height,left:0,top:0,format:"png"}),e=document.createElement("a");e.download="canvas.png",e.href=t,document.body.appendChild(e),e.click(),document.body.removeChild(e)}}},d=u,h=(n("58a6"),n("2877")),f=Object(h["a"])(d,a,i,!1,null,"03e0cd2c",null);e["default"]=f.exports},"44e7":function(t,e,n){var a=n("861d"),i=n("c6b6"),o=n("b622"),r=o("match");t.exports=function(t){var e;return a(t)&&(void 0!==(e=t[r])?!!e:"RegExp"==i(t))}},"4dae":function(t,e,n){var a=n("da84"),i=n("23cb"),o=n("07fa"),r=n("8418"),c=a.Array,s=Math.max;t.exports=function(t,e,n){for(var a=o(t),l=i(e,a),u=i(void 0===n?a:n,a),d=c(s(u-l,0)),h=0;l<u;l++,h++)r(d,h,t[l]);return d.length=h,d}},"4df4":function(t,e,n){"use strict";var a=n("da84"),i=n("0366"),o=n("c65b"),r=n("7b0b"),c=n("9bdd"),s=n("e95a"),l=n("68ee"),u=n("07fa"),d=n("8418"),h=n("9a1f"),f=n("35a1"),v=a.Array;t.exports=function(t){var e=r(t),n=l(this),a=arguments.length,g=a>1?arguments[1]:void 0,p=void 0!==g;p&&(g=i(g,a>2?arguments[2]:void 0));var b,m,x,w,y,k,I=f(e),C=0;if(!I||this==v&&s(I))for(b=u(e),m=n?new this(b):v(b);b>C;C++)k=p?g(e[C],C):e[C],d(m,C,k);else for(w=h(e,I),y=w.next,m=n?new this:[];!(x=o(y,w)).done;C++)k=p?c(w,g,[x.value,C],!0):x.value,d(m,C,k);return m.length=C,m}},"4e82":function(t,e,n){"use strict";var a=n("23e7"),i=n("e330"),o=n("59ed"),r=n("7b0b"),c=n("07fa"),s=n("577e"),l=n("d039"),u=n("addb"),d=n("a640"),h=n("04d1"),f=n("d998"),v=n("2d00"),g=n("512ce"),p=[],b=i(p.sort),m=i(p.push),x=l((function(){p.sort(void 0)})),w=l((function(){p.sort(null)})),y=d("sort"),k=!l((function(){if(v)return v<70;if(!(h&&h>3)){if(f)return!0;if(g)return g<603;var t,e,n,a,i="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(a=0;a<47;a++)p.push({k:e+a,v:n})}for(p.sort((function(t,e){return e.v-t.v})),a=0;a<p.length;a++)e=p[a].k.charAt(0),i.charAt(i.length-1)!==e&&(i+=e);return"DGBEFHACIJK"!==i}})),I=x||!w||!y||!k,C=function(t){return function(e,n){return void 0===n?-1:void 0===e?1:void 0!==t?+t(e,n)||0:s(e)>s(n)?1:-1}};a({target:"Array",proto:!0,forced:I},{sort:function(t){void 0!==t&&o(t);var e=r(this);if(k)return void 0===t?b(e):b(e,t);var n,a,i=[],s=c(e);for(a=0;a<s;a++)a in e&&m(i,e[a]);u(i,C(t)),n=i.length,a=0;while(a<n)e[a]=i[a++];while(a<s)delete e[a++];return e}})},"512ce":function(t,e,n){var a=n("342f"),i=a.match(/AppleWebKit\/(\d+)\./);t.exports=!!i&&+i[1]},"58a6":function(t,e,n){"use strict";n("0c1f")},"8aa5":function(t,e,n){"use strict";var a=n("6547").charAt;t.exports=function(t,e,n){return e+(n?a(t,e).length:1)}},9263:function(t,e,n){"use strict";var a=n("c65b"),i=n("e330"),o=n("577e"),r=n("ad6d"),c=n("9f7f"),s=n("5692"),l=n("7c73"),u=n("69f3").get,d=n("fce3"),h=n("107c"),f=s("native-string-replace",String.prototype.replace),v=RegExp.prototype.exec,g=v,p=i("".charAt),b=i("".indexOf),m=i("".replace),x=i("".slice),w=function(){var t=/a/,e=/b*/g;return a(v,t,"a"),a(v,e,"a"),0!==t.lastIndex||0!==e.lastIndex}(),y=c.BROKEN_CARET,k=void 0!==/()??/.exec("")[1],I=w||k||y||d||h;I&&(g=function(t){var e,n,i,c,s,d,h,I=this,C=u(I),E=o(t),R=C.raw;if(R)return R.lastIndex=I.lastIndex,e=a(g,R,E),I.lastIndex=R.lastIndex,e;var M=C.groups,L=y&&I.sticky,_=a(r,I),A=I.source,D=0,P=E;if(L&&(_=m(_,"y",""),-1===b(_,"g")&&(_+="g"),P=x(E,I.lastIndex),I.lastIndex>0&&(!I.multiline||I.multiline&&"\n"!==p(E,I.lastIndex-1))&&(A="(?: "+A+")",P=" "+P,D++),n=new RegExp("^(?:"+A+")",_)),k&&(n=new RegExp("^"+A+"$(?!\\s)",_)),w&&(i=I.lastIndex),c=a(v,L?n:I,P),L?c?(c.input=x(c.input,D),c[0]=x(c[0],D),c.index=I.lastIndex,I.lastIndex+=c[0].length):I.lastIndex=0:w&&c&&(I.lastIndex=I.global?c.index+c[0].length:i),k&&c&&c.length>1&&a(f,c[0],n,(function(){for(s=1;s<arguments.length-2;s++)void 0===arguments[s]&&(c[s]=void 0)})),c&&M)for(c.groups=d=l(null),s=0;s<M.length;s++)h=M[s],d[h[0]]=c[h[1]];return c}),t.exports=g},"9bdd":function(t,e,n){var a=n("825a"),i=n("2a62");t.exports=function(t,e,n,o){try{return o?e(a(n)[0],n[1]):e(n)}catch(r){i(t,"throw",r)}}},"9f7f":function(t,e,n){var a=n("d039"),i=n("da84"),o=i.RegExp,r=a((function(){var t=o("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),c=r||a((function(){return!o("a","y").sticky})),s=r||a((function(){var t=o("^r","gy");return t.lastIndex=2,null!=t.exec("str")}));t.exports={BROKEN_CARET:s,MISSED_STICKY:c,UNSUPPORTED_Y:r}},a640:function(t,e,n){"use strict";var a=n("d039");t.exports=function(t,e){var n=[][t];return!!n&&a((function(){n.call(null,e||function(){return 1},1)}))}},ac1f:function(t,e,n){"use strict";var a=n("23e7"),i=n("9263");a({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},ad6d:function(t,e,n){"use strict";var a=n("825a");t.exports=function(){var t=a(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},d784:function(t,e,n){"use strict";n("ac1f");var a=n("e330"),i=n("6eeb"),o=n("9263"),r=n("d039"),c=n("b622"),s=n("9112"),l=c("species"),u=RegExp.prototype;t.exports=function(t,e,n,d){var h=c(t),f=!r((function(){var e={};return e[h]=function(){return 7},7!=""[t](e)})),v=f&&!r((function(){var e=!1,n=/a/;return"split"===t&&(n={},n.constructor={},n.constructor[l]=function(){return n},n.flags="",n[h]=/./[h]),n.exec=function(){return e=!0,null},n[h](""),!e}));if(!f||!v||n){var g=a(/./[h]),p=e(h,""[t],(function(t,e,n,i,r){var c=a(t),s=e.exec;return s===o||s===u.exec?f&&!r?{done:!0,value:g(e,n,i)}:{done:!0,value:c(n,e,i)}:{done:!1}}));i(String.prototype,t,p[0]),i(u,h,p[1])}d&&s(u[h],"sham",!0)}},d998:function(t,e,n){var a=n("342f");t.exports=/MSIE|Trident/.test(a)},fce3:function(t,e,n){var a=n("d039"),i=n("da84"),o=i.RegExp;t.exports=a((function(){var t=o(".","s");return!(t.dotAll&&t.exec("\n")&&"s"===t.flags)}))}}]);
//# sourceMappingURL=chunk-3da416f0.2627f1c5.js.map